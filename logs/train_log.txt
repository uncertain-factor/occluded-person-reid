2024-05-08 00:23:33,317 transreid INFO: Saving model in the path :/home/zyj/workspace/workspace/CLIP-ReID-zhy/occluded-person-reid/logs
2024-05-08 00:23:33,317 transreid INFO: Namespace(config_file='configs/person/vit_new.yml', local_rank=0, opts=[])
2024-05-08 00:23:33,317 transreid INFO: Loaded configuration file configs/person/vit_new.yml
2024-05-08 00:23:33,317 transreid INFO: 
MODEL:
  PRETRAIN_CHOICE: 'imagenet'
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'on'
  IF_WITH_CENTER: 'no'
  NAME: 'ViT-B-16'
  STRIDE_SIZE: [16, 16]
  ID_LOSS_WEIGHT : 0.25
  TRIPLET_LOSS_WEIGHT : 1.0
  I2T_LOSS_WEIGHT : 1.0
  # SIE_CAMERA: True
  # SIE_COE : 1.0

INPUT:
  SIZE_TRAIN: [256, 128]
  SIZE_TEST: [256, 128]
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.5 # random erasing
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]

DATALOADER:
  SAMPLER: 'softmax_triplet'
  NUM_INSTANCE: 5 #每个身份选择的样本数量,原本是4
  NUM_WORKERS: 5  #数据加载的进程数，原本是8

SOLVER:
  STAGE1:
    IMS_PER_BATCH: 25 # 原本是64
    OPTIMIZER_NAME: "Adam"
    BASE_LR: 0.00035
    WARMUP_LR_INIT: 0.00001
    LR_MIN: 1e-6
    WARMUP_METHOD: 'linear'
    WEIGHT_DECAY:  1e-4
    WEIGHT_DECAY_BIAS: 1e-4
    MAX_EPOCHS: 50
    CHECKPOINT_PERIOD: 50
    LOG_PERIOD: 16  # 输出日志的batch周期，原本为50
    WARMUP_EPOCHS: 5

  STAGE2:
    IMS_PER_BATCH: 15 # 阶段二数据加载器的每个采样批次的大小为30，取10个id的5张照片，原本是64
    OPTIMIZER_NAME: "Adam"
    BASE_LR: 0.000005
    WARMUP_METHOD: 'linear'
    WARMUP_ITERS: 10
    WARMUP_FACTOR: 0.1
    WEIGHT_DECAY:  0.0001
    WEIGHT_DECAY_BIAS: 0.0001
    LARGE_FC_LR: False
    MAX_EPOCHS: 60
    CHECKPOINT_PERIOD: 16
    LOG_PERIOD: 16
    EVAL_PERIOD: 60
    BIAS_LR_FACTOR: 2

    STEPS: [30, 50]
    GAMMA: 0.1

TEST:
  EVAL: True
  IMS_PER_BATCH: 25
  RE_RANKING: False
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'

DATASETS:
  NAMES: ('occ_reid')
  ROOT_DIR: ('/home/zyj/workspace/workspace/CLIP-ReID-zhy/')
OUTPUT_DIR: '/home/zyj/workspace/workspace/CLIP-ReID-zhy/occluded-person-reid/logs'


2024-05-08 00:23:33,317 transreid INFO: Running with config:
DATALOADER:
  NUM_INSTANCE: 5
  NUM_WORKERS: 5
  SAMPLER: softmax_triplet
DATASETS:
  NAMES: occ_reid
  ROOT_DIR: /home/zyj/workspace/workspace/CLIP-ReID-zhy/
INPUT:
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]
  PROB: 0.5
  RE_PROB: 0.5
  SIZE_TEST: [256, 128]
  SIZE_TRAIN: [256, 128]
MODEL:
  ATT_DROP_RATE: 0.0
  COS_LAYER: False
  DEVICE: cuda
  DEVICE_ID: 0
  DIST_TRAIN: False
  DROP_OUT: 0.0
  DROP_PATH: 0.1
  I2T_LOSS_WEIGHT: 1.0
  ID_LOSS_TYPE: softmax
  ID_LOSS_WEIGHT: 0.25
  IF_LABELSMOOTH: on
  IF_WITH_CENTER: no
  LAST_STRIDE: 1
  METRIC_LOSS_TYPE: triplet
  NAME: ViT-B-16
  NECK: bnneck
  NO_MARGIN: False
  PRETRAIN_CHOICE: imagenet
  PRETRAIN_PATH: 
  SIE_CAMERA: False
  SIE_COE: 3.0
  SIE_VIEW: False
  STRIDE_SIZE: [16, 16]
  TRANSFORMER_TYPE: None
  TRIPLET_LOSS_WEIGHT: 1.0
OUTPUT_DIR: /home/zyj/workspace/workspace/CLIP-ReID-zhy/occluded-person-reid/logs
SOLVER:
  MARGIN: 0.3
  SEED: 1234
  STAGE1:
    BASE_LR: 0.00035
    CHECKPOINT_PERIOD: 50
    COSINE_MARGIN: 0.5
    COSINE_SCALE: 30
    EVAL_PERIOD: 10
    IMS_PER_BATCH: 25
    LOG_PERIOD: 16
    LR_MIN: 1e-06
    MAX_EPOCHS: 50
    MOMENTUM: 0.9
    OPTIMIZER_NAME: Adam
    WARMUP_EPOCHS: 5
    WARMUP_FACTOR: 0.01
    WARMUP_ITERS: 500
    WARMUP_LR_INIT: 1e-05
    WARMUP_METHOD: linear
    WEIGHT_DECAY: 0.0001
    WEIGHT_DECAY_BIAS: 0.0001
  STAGE2:
    BASE_LR: 5e-06
    BIAS_LR_FACTOR: 2
    CENTER_LOSS_WEIGHT: 0.0005
    CENTER_LR: 0.5
    CHECKPOINT_PERIOD: 16
    COSINE_MARGIN: 0.5
    COSINE_SCALE: 30
    EVAL_PERIOD: 60
    GAMMA: 0.1
    IMS_PER_BATCH: 15
    LARGE_FC_LR: False
    LOG_PERIOD: 16
    LR_MIN: 1.6e-05
    MAX_EPOCHS: 60
    MOMENTUM: 0.9
    OPTIMIZER_NAME: Adam
    STEPS: (30, 50)
    WARMUP_EPOCHS: 5
    WARMUP_FACTOR: 0.1
    WARMUP_ITERS: 10
    WARMUP_LR_INIT: 0.01
    WARMUP_METHOD: linear
    WEIGHT_DECAY: 0.0001
    WEIGHT_DECAY_BIAS: 0.0001
TEST:
  DIST_MAT: dist_mat.npy
  EVAL: True
  FEAT_NORM: yes
  IMS_PER_BATCH: 25
  NECK_FEAT: before
  RE_RANKING: False
  WEIGHT: 
2024-05-08 00:23:36,882 transreid.train INFO: start training stage1
2024-05-08 00:23:38,984 transreid.train INFO: Epoch[1] Iteration[16/32] Loss: 9.313, Base Lr: 7.80e-05
2024-05-08 00:23:39,606 transreid.train INFO: Epoch[1] Iteration[32/32] Loss: 8.443, Base Lr: 7.80e-05
2024-05-08 00:23:40,231 transreid.train INFO: Epoch[2] Iteration[16/32] Loss: 5.561, Base Lr: 1.46e-04
2024-05-08 00:23:40,854 transreid.train INFO: Epoch[2] Iteration[32/32] Loss: 5.059, Base Lr: 1.46e-04
2024-05-08 00:23:41,479 transreid.train INFO: Epoch[3] Iteration[16/32] Loss: 3.376, Base Lr: 2.14e-04
2024-05-08 00:23:42,105 transreid.train INFO: Epoch[3] Iteration[32/32] Loss: 3.134, Base Lr: 2.14e-04
2024-05-08 00:23:42,739 transreid.train INFO: Epoch[4] Iteration[16/32] Loss: 1.970, Base Lr: 2.82e-04
2024-05-08 00:23:43,376 transreid.train INFO: Epoch[4] Iteration[32/32] Loss: 1.985, Base Lr: 2.82e-04
2024-05-08 00:23:44,004 transreid.train INFO: Epoch[5] Iteration[16/32] Loss: 1.427, Base Lr: 3.41e-04
2024-05-08 00:23:44,636 transreid.train INFO: Epoch[5] Iteration[32/32] Loss: 1.460, Base Lr: 3.41e-04
2024-05-08 00:23:45,265 transreid.train INFO: Epoch[6] Iteration[16/32] Loss: 1.062, Base Lr: 3.38e-04
2024-05-08 00:23:45,894 transreid.train INFO: Epoch[6] Iteration[32/32] Loss: 1.104, Base Lr: 3.38e-04
2024-05-08 00:23:46,530 transreid.train INFO: Epoch[7] Iteration[16/32] Loss: 0.737, Base Lr: 3.33e-04
2024-05-08 00:23:47,161 transreid.train INFO: Epoch[7] Iteration[32/32] Loss: 0.736, Base Lr: 3.33e-04
2024-05-08 00:23:47,798 transreid.train INFO: Epoch[8] Iteration[16/32] Loss: 0.520, Base Lr: 3.28e-04
2024-05-08 00:23:48,432 transreid.train INFO: Epoch[8] Iteration[32/32] Loss: 0.523, Base Lr: 3.28e-04
2024-05-08 00:23:49,066 transreid.train INFO: Epoch[9] Iteration[16/32] Loss: 0.384, Base Lr: 3.23e-04
2024-05-08 00:23:49,711 transreid.train INFO: Epoch[9] Iteration[32/32] Loss: 0.406, Base Lr: 3.23e-04
2024-05-08 00:23:50,388 transreid.train INFO: Epoch[10] Iteration[16/32] Loss: 0.348, Base Lr: 3.17e-04
2024-05-08 00:23:51,098 transreid.train INFO: Epoch[10] Iteration[32/32] Loss: 0.359, Base Lr: 3.17e-04
2024-05-08 00:23:51,833 transreid.train INFO: Epoch[11] Iteration[16/32] Loss: 0.245, Base Lr: 3.10e-04
2024-05-08 00:23:52,584 transreid.train INFO: Epoch[11] Iteration[32/32] Loss: 0.291, Base Lr: 3.10e-04
2024-05-08 00:23:53,355 transreid.train INFO: Epoch[12] Iteration[16/32] Loss: 0.322, Base Lr: 3.03e-04
2024-05-08 00:23:54,135 transreid.train INFO: Epoch[12] Iteration[32/32] Loss: 0.324, Base Lr: 3.03e-04
2024-05-08 00:23:54,930 transreid.train INFO: Epoch[13] Iteration[16/32] Loss: 0.266, Base Lr: 2.95e-04
2024-05-08 00:23:55,734 transreid.train INFO: Epoch[13] Iteration[32/32] Loss: 0.290, Base Lr: 2.95e-04
2024-05-08 00:23:56,555 transreid.train INFO: Epoch[14] Iteration[16/32] Loss: 0.261, Base Lr: 2.87e-04
2024-05-08 00:23:57,379 transreid.train INFO: Epoch[14] Iteration[32/32] Loss: 0.225, Base Lr: 2.87e-04
2024-05-08 00:23:58,203 transreid.train INFO: Epoch[15] Iteration[16/32] Loss: 0.284, Base Lr: 2.78e-04
2024-05-08 00:23:59,045 transreid.train INFO: Epoch[15] Iteration[32/32] Loss: 0.266, Base Lr: 2.78e-04
2024-05-08 00:23:59,883 transreid.train INFO: Epoch[16] Iteration[16/32] Loss: 0.267, Base Lr: 2.69e-04
2024-05-08 00:24:00,741 transreid.train INFO: Epoch[16] Iteration[32/32] Loss: 0.274, Base Lr: 2.69e-04
2024-05-08 00:24:01,606 transreid.train INFO: Epoch[17] Iteration[16/32] Loss: 0.223, Base Lr: 2.60e-04
2024-05-08 00:24:02,472 transreid.train INFO: Epoch[17] Iteration[32/32] Loss: 0.243, Base Lr: 2.60e-04
2024-05-08 00:24:03,347 transreid.train INFO: Epoch[18] Iteration[16/32] Loss: 0.268, Base Lr: 2.50e-04
2024-05-08 00:24:04,225 transreid.train INFO: Epoch[18] Iteration[32/32] Loss: 0.265, Base Lr: 2.50e-04
2024-05-08 00:24:05,109 transreid.train INFO: Epoch[19] Iteration[16/32] Loss: 0.217, Base Lr: 2.40e-04
2024-05-08 00:24:06,007 transreid.train INFO: Epoch[19] Iteration[32/32] Loss: 0.215, Base Lr: 2.40e-04
2024-05-08 00:24:06,913 transreid.train INFO: Epoch[20] Iteration[16/32] Loss: 0.197, Base Lr: 2.29e-04
2024-05-08 00:24:07,741 transreid.train INFO: Epoch[20] Iteration[32/32] Loss: 0.204, Base Lr: 2.29e-04
2024-05-08 00:24:08,607 transreid.train INFO: Epoch[21] Iteration[16/32] Loss: 0.198, Base Lr: 2.19e-04
2024-05-08 00:24:09,445 transreid.train INFO: Epoch[21] Iteration[32/32] Loss: 0.172, Base Lr: 2.19e-04
2024-05-08 00:24:10,292 transreid.train INFO: Epoch[22] Iteration[16/32] Loss: 0.222, Base Lr: 2.08e-04
2024-05-08 00:24:11,067 transreid.train INFO: Epoch[22] Iteration[32/32] Loss: 0.271, Base Lr: 2.08e-04
2024-05-08 00:24:11,885 transreid.train INFO: Epoch[23] Iteration[16/32] Loss: 0.246, Base Lr: 1.97e-04
2024-05-08 00:24:12,692 transreid.train INFO: Epoch[23] Iteration[32/32] Loss: 0.256, Base Lr: 1.97e-04
2024-05-08 00:24:13,447 transreid.train INFO: Epoch[24] Iteration[16/32] Loss: 0.196, Base Lr: 1.86e-04
2024-05-08 00:24:14,249 transreid.train INFO: Epoch[24] Iteration[32/32] Loss: 0.207, Base Lr: 1.86e-04
2024-05-08 00:24:15,058 transreid.train INFO: Epoch[25] Iteration[16/32] Loss: 0.176, Base Lr: 1.75e-04
2024-05-08 00:24:15,869 transreid.train INFO: Epoch[25] Iteration[32/32] Loss: 0.171, Base Lr: 1.75e-04
2024-05-08 00:24:16,629 transreid.train INFO: Epoch[26] Iteration[16/32] Loss: 0.208, Base Lr: 1.65e-04
2024-05-08 00:24:17,386 transreid.train INFO: Epoch[26] Iteration[32/32] Loss: 0.205, Base Lr: 1.65e-04
2024-05-08 00:24:18,093 transreid.train INFO: Epoch[27] Iteration[16/32] Loss: 0.167, Base Lr: 1.54e-04
2024-05-08 00:24:18,863 transreid.train INFO: Epoch[27] Iteration[32/32] Loss: 0.181, Base Lr: 1.54e-04
2024-05-08 00:24:19,633 transreid.train INFO: Epoch[28] Iteration[16/32] Loss: 0.182, Base Lr: 1.43e-04
2024-05-08 00:24:20,406 transreid.train INFO: Epoch[28] Iteration[32/32] Loss: 0.193, Base Lr: 1.43e-04
2024-05-08 00:24:21,125 transreid.train INFO: Epoch[29] Iteration[16/32] Loss: 0.245, Base Lr: 1.32e-04
2024-05-08 00:24:21,857 transreid.train INFO: Epoch[29] Iteration[32/32] Loss: 0.226, Base Lr: 1.32e-04
2024-05-08 00:24:22,584 transreid.train INFO: Epoch[30] Iteration[16/32] Loss: 0.184, Base Lr: 1.22e-04
2024-05-08 00:24:23,375 transreid.train INFO: Epoch[30] Iteration[32/32] Loss: 0.213, Base Lr: 1.22e-04
2024-05-08 00:24:24,169 transreid.train INFO: Epoch[31] Iteration[16/32] Loss: 0.226, Base Lr: 1.11e-04
2024-05-08 00:24:24,966 transreid.train INFO: Epoch[31] Iteration[32/32] Loss: 0.205, Base Lr: 1.11e-04
2024-05-08 00:24:25,755 transreid.train INFO: Epoch[32] Iteration[16/32] Loss: 0.281, Base Lr: 1.01e-04
2024-05-08 00:24:26,486 transreid.train INFO: Epoch[32] Iteration[32/32] Loss: 0.230, Base Lr: 1.01e-04
2024-05-08 00:24:27,227 transreid.train INFO: Epoch[33] Iteration[16/32] Loss: 0.256, Base Lr: 9.14e-05
2024-05-08 00:24:28,028 transreid.train INFO: Epoch[33] Iteration[32/32] Loss: 0.227, Base Lr: 9.14e-05
2024-05-08 00:24:28,833 transreid.train INFO: Epoch[34] Iteration[16/32] Loss: 0.232, Base Lr: 8.20e-05
2024-05-08 00:24:29,585 transreid.train INFO: Epoch[34] Iteration[32/32] Loss: 0.221, Base Lr: 8.20e-05
2024-05-08 00:24:30,343 transreid.train INFO: Epoch[35] Iteration[16/32] Loss: 0.174, Base Lr: 7.29e-05
2024-05-08 00:24:31,100 transreid.train INFO: Epoch[35] Iteration[32/32] Loss: 0.216, Base Lr: 7.29e-05
2024-05-08 00:24:31,863 transreid.train INFO: Epoch[36] Iteration[16/32] Loss: 0.236, Base Lr: 6.43e-05
2024-05-08 00:24:32,688 transreid.train INFO: Epoch[36] Iteration[32/32] Loss: 0.230, Base Lr: 6.43e-05
2024-05-08 00:24:33,482 transreid.train INFO: Epoch[37] Iteration[16/32] Loss: 0.251, Base Lr: 5.60e-05
2024-05-08 00:24:34,292 transreid.train INFO: Epoch[37] Iteration[32/32] Loss: 0.246, Base Lr: 5.60e-05
2024-05-08 00:24:35,053 transreid.train INFO: Epoch[38] Iteration[16/32] Loss: 0.178, Base Lr: 4.83e-05
2024-05-08 00:24:35,830 transreid.train INFO: Epoch[38] Iteration[32/32] Loss: 0.164, Base Lr: 4.83e-05
2024-05-08 00:24:36,605 transreid.train INFO: Epoch[39] Iteration[16/32] Loss: 0.147, Base Lr: 4.10e-05
2024-05-08 00:24:37,432 transreid.train INFO: Epoch[39] Iteration[32/32] Loss: 0.173, Base Lr: 4.10e-05
2024-05-08 00:24:38,280 transreid.train INFO: Epoch[40] Iteration[16/32] Loss: 0.197, Base Lr: 3.43e-05
2024-05-08 00:24:39,126 transreid.train INFO: Epoch[40] Iteration[32/32] Loss: 0.211, Base Lr: 3.43e-05
2024-05-08 00:24:39,974 transreid.train INFO: Epoch[41] Iteration[16/32] Loss: 0.213, Base Lr: 2.82e-05
2024-05-08 00:24:40,770 transreid.train INFO: Epoch[41] Iteration[32/32] Loss: 0.192, Base Lr: 2.82e-05
2024-05-08 00:24:41,555 transreid.train INFO: Epoch[42] Iteration[16/32] Loss: 0.169, Base Lr: 2.26e-05
2024-05-08 00:24:42,350 transreid.train INFO: Epoch[42] Iteration[32/32] Loss: 0.172, Base Lr: 2.26e-05
2024-05-08 00:24:43,149 transreid.train INFO: Epoch[43] Iteration[16/32] Loss: 0.230, Base Lr: 1.76e-05
2024-05-08 00:24:44,011 transreid.train INFO: Epoch[43] Iteration[32/32] Loss: 0.225, Base Lr: 1.76e-05
2024-05-08 00:24:44,874 transreid.train INFO: Epoch[44] Iteration[16/32] Loss: 0.191, Base Lr: 1.33e-05
2024-05-08 00:24:45,749 transreid.train INFO: Epoch[44] Iteration[32/32] Loss: 0.212, Base Lr: 1.33e-05
2024-05-08 00:24:46,620 transreid.train INFO: Epoch[45] Iteration[16/32] Loss: 0.196, Base Lr: 9.54e-06
2024-05-08 00:24:47,483 transreid.train INFO: Epoch[45] Iteration[32/32] Loss: 0.178, Base Lr: 9.54e-06
2024-05-08 00:24:48,290 transreid.train INFO: Epoch[46] Iteration[16/32] Loss: 0.176, Base Lr: 6.48e-06
2024-05-08 00:24:49,095 transreid.train INFO: Epoch[46] Iteration[32/32] Loss: 0.167, Base Lr: 6.48e-06
2024-05-08 00:24:49,907 transreid.train INFO: Epoch[47] Iteration[16/32] Loss: 0.157, Base Lr: 4.09e-06
2024-05-08 00:24:50,749 transreid.train INFO: Epoch[47] Iteration[32/32] Loss: 0.175, Base Lr: 4.09e-06
2024-05-08 00:24:51,630 transreid.train INFO: Epoch[48] Iteration[16/32] Loss: 0.233, Base Lr: 2.38e-06
2024-05-08 00:24:52,522 transreid.train INFO: Epoch[48] Iteration[32/32] Loss: 0.187, Base Lr: 2.38e-06
2024-05-08 00:24:53,399 transreid.train INFO: Epoch[49] Iteration[16/32] Loss: 0.217, Base Lr: 1.34e-06
2024-05-08 00:24:54,275 transreid.train INFO: Epoch[49] Iteration[32/32] Loss: 0.196, Base Lr: 1.34e-06
2024-05-08 00:24:55,169 transreid.train INFO: Epoch[50] Iteration[16/32] Loss: 0.160, Base Lr: 1.00e-06
2024-05-08 00:24:56,070 transreid.train INFO: Epoch[50] Iteration[32/32] Loss: 0.193, Base Lr: 1.00e-06
2024-05-08 00:24:56,703 transreid.train INFO: Stage1 running time: 0:01:19.818650
2024-05-08 00:24:56,709 transreid.train INFO: start training
2024-05-08 00:25:02,661 transreid.train INFO: Epoch[1] Iteration[16/54] Loss: 33.758, Acc: 0.763, Base Lr: 9.50e-07
2024-05-08 00:25:08,783 transreid.train INFO: Epoch[1] Iteration[32/54] Loss: 29.084, Acc: 0.819, Base Lr: 9.50e-07
2024-05-08 00:25:14,962 transreid.train INFO: Epoch[1] Iteration[48/54] Loss: 26.070, Acc: 0.844, Base Lr: 9.50e-07
2024-05-08 00:25:16,948 transreid.train INFO: Epoch 1 done. Time per batch: 0.380[s] Speed: 39.5[samples/s]
2024-05-08 00:25:23,331 transreid.train INFO: Epoch[2] Iteration[16/54] Loss: 16.981, Acc: 0.771, Base Lr: 1.40e-06
2024-05-08 00:25:29,658 transreid.train INFO: Epoch[2] Iteration[32/54] Loss: 16.047, Acc: 0.733, Base Lr: 1.40e-06
2024-05-08 00:25:36,043 transreid.train INFO: Epoch[2] Iteration[48/54] Loss: 15.426, Acc: 0.728, Base Lr: 1.40e-06
2024-05-08 00:25:38,079 transreid.train INFO: Epoch 2 done. Time per batch: 0.399[s] Speed: 37.6[samples/s]
